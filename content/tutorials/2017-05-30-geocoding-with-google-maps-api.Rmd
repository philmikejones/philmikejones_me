---
title: Geocoding with Google Geocoding API and Googleway
author: Phil Mike Jones
date: 2017-05-30
slug: geocoding-google-geocoding-api-googleway
categories: [tutorials]
tags: [geocode]
---

Geocoding is the process of taking an address, postcode, or other human--readable identifier and converting it into coordinates.
Here I use the [Google Geocoding API](https://developers.google.com/maps/documentation/geocoding/intro) which I access within R with the [`googleway`](https://cran.r-project.org/package=googleway) package.

<!--more-->

To use the Google Geocoding API service we need an API key:

- Open the [Get API Key](https://developers.google.com/maps/documentation/geocoding/get-api-key) page
- Click Get Started
- When asked, you need to enable the `Places` product. Tick this and press Continue
- Select or create a project. If this is the first time you're using this service you will need to create a new project. Type a project name and press Next
- You'll need to set up a billing account and provide a debit or credit card. You can set it up so that your budget is Â£0/$0 so it will never be charged, but I can't see a way around having to provide it.
- Follow the prompts and click Next or Continue
- You'll be told, 'You're all set', and be presented with your API key.

!["Google Geocoding set up"](enable-geocoding-platform.png)

You need to build a URL to query the Google Places API, one URL per place. Judging by the Places API guide you need to:

 1. [Get an API key](https://developers.google.com/places/web-service/get-api-key)
 2. Obtain a `placeid` from a places search, then
 3. Use this `placeid` to get information from the Place Details API.

The base URL is:

    https://maps.googleapis.com/maps/api/place/nearbysearch/output?parameters

`JSON` is the recommended output format, and we need to specify the following [parameters](https://developers.google.com/places/web-service/search):

 1. `key`: your API key
 2. `location`: lat/long (NOT long/lat!) coordinates of the centre of
    your search area
 3. `radius`: the radius to search in metres
 4. `keyword` or `name`: keywords or name of the place to search

So build this up in R:

    places_key = "Your key goes here"
    url = paste0("https://maps.googleapis.com/maps/api/place/",
                 "nearbysearch/json?key=", places_key,
                 "&location=41.699042,-72.864847",
                 "&radius=5000",  # max = 50,000
                 "&name=ebm-papst")

Query the URL with

    install.packages("jsonlite")  # if not already installed
    result <- jsonlite::fromJSON(url)

The `placeid`(s) is/are then in `result$results$placeid`.

Plug this `placeid` into a Google Places Details API query:

    details_id  <- result$results$placeid

If there is more than one `placeid` you can specify which one you want with `result$results$placeid[1]`, for example for the first `placeid`

    details_url <- paste0("https://maps.googleapis.com/maps/api/place/",
                          "details/json?",
                          "key=", places_key,
                          "&placeid=", details_id)

    details <- jsonlite::fromJSON(details_url)
